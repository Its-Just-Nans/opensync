digraph {
    START[init="true"];
    START -> CRT_VERIFY[label="START"];
    CRT_VERIFY -> EST_START;
    CRT_VERIFY -> IDLE;
    EST_START -> EST_RESET[label="STATE_INIT"];
    EST_RESET -> EST_CACERTS[label="STATE_INIT"];
    EST_CACERTS -> EST_ENROLL[label="EST_SUCCESS"];
    EST_CACERTS -> EST_RETRY[label="STATE_INIT,TIMEOUT,EST_ERROR"];
    EST_ENROLL -> EST_DONE[label="EST_SUCCESS"];
    EST_ENROLL -> EST_RETRY[label="STATE_INIT,TIMEOUT,EST_ERROR"];
    EST_DONE -> CRT_VERIFY[label="STATE_INIT"];
    EST_DONE -> EST_RETRY[label="STATE_INIT"];
    EST_RETRY -> EST_RESET[label="TIMEOUT"];
    IDLE -> EST_START[label="STATE_INIT,TIMEOUT,EXPIRE_CHECK"];
    EXCEPTION -> EST_START[label="!EST_RENEW"];
}
